'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.markQuestion = markQuestion;
exports.getAnswer = getAnswer;

var _models = require('../models');

var _variables = require('../generate/variables');

var _mathjs = require('mathjs');

var _mathjs2 = _interopRequireDefault(_mathjs);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function markQuestion(question, problem) {
  var result = new _models.Result(true, []);
  for (var i = 0; i < problem.answer.length; i++) {
    var answer = (0, _variables.insertVariables)(problem.answer[i], question.variables);
    var answerValue = _mathjs2.default.eval(answer); // evaluate expression using mathjs
    result.answer[i] = answerValue;
    if (result.correct) result.correct = answerValue == question.userAnswer[i];
  }
  return result;
}

function getAnswer(question, problem) {
  var answerValues = [];
  for (var i = 0; i < problem.answer.length; i++) {
    var answer = (0, _variables.insertVariables)(problem.answer[i], question.variables);
    var answerValue = _mathjs2.default.eval(answer);
    answer.push(answerValue);
  }
  return formatAnswer(problem.answerFormat, answerValues);
}

function formatAnswer(answer, format) {
  var split = format.split("");
  for (var i = 0; i < split.length; i++) {
    if (!isNaN(split[i])) {
      split[i] = answer[split[i]];
    }
  }
  return split.join("");
}